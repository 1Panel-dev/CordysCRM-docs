# æºç ç¼–è¯‘è¿è¡Œ

!!! Abstract ""

    è¯·ä½¿ç”¨ v1.3.0 ç­‰å·²å‘å¸ƒåˆ†æ”¯çš„ä»£ç è¿è¡Œ CordysCRMã€‚è¯·å‹¿ä½¿ç”¨ main åˆ†æ”¯ï¼Œmain åˆ†æ”¯ä»£ç å‡å¤„äºå¼€å‘æˆ–æµ‹è¯•é˜¶æ®µï¼Œå¯èƒ½å­˜åœ¨è¾ƒæ˜æ˜¾åŠŸèƒ½ç¼ºé™·ã€‚   

!!! Abstract ""

    ç›®å‰æ”¯æŒçš„æºç è¿è¡Œç¯å¢ƒæœ‰ï¼š Windows (x86)ã€Linuxï¼ˆx86 & arm64ï¼‰ã€MacOSï¼ˆx86 & arm64ï¼‰ã€‚

## 1 é¡¹ç›®ç»“æ„

!!! Abstract ""

    ``` 
    â”œâ”€â”€ backend                                  # åç«¯é¡¹ç›®
    â”‚   â”œâ”€â”€ app                                  # åº”ç”¨ç¨‹åºæ¨¡å—
    â”‚   â”œâ”€â”€ crm                                  # CRM æ ¸å¿ƒæ¨¡å—
    â”‚   â””â”€â”€ framework                            # é€šç”¨æ¡†æ¶æ¨¡å—
    â”œâ”€â”€ frontend                                 # å‰ç«¯é¡¹ç›®
    â”‚   â”œâ”€â”€ packages                             # å‰ç«¯åŒ…ç®¡ç†
    â”‚   â”‚   â”œâ”€â”€ lib-shared                       # å…¬å…±åº“æ¨¡å—
    â”‚   â”‚   â”‚   â”œâ”€â”€ api                          # API å°è£…
    â”‚   â”‚   â”‚   â”œâ”€â”€ assets                       # é™æ€èµ„æº
    â”‚   â”‚   â”‚   â”œâ”€â”€ enums                        # æšä¸¾
    â”‚   â”‚   â”‚   â”œâ”€â”€ hooks                        # é’©å­å‡½æ•°
    â”‚   â”‚   â”‚   â”œâ”€â”€ locale                       # å›½é™…åŒ–å°è£…
    â”‚   â”‚   â”‚   â”œâ”€â”€ method                       # å·¥å…·å‡½æ•°
    â”‚   â”‚   â”‚   â”œâ”€â”€ model                        # æ•°æ®æ¨¡å‹
    â”‚   â”‚   â”‚   â”œâ”€â”€ types                        # å…¨å±€ç±»å‹å£°æ˜
    â”‚   â”‚   â”œâ”€â”€ mobile                           # ç§»åŠ¨ç«¯é¡¹ç›®
    â”‚   â”‚   â”œâ”€â”€ web                              # WEBç«¯é¡¹ç›®
    â”œâ”€â”€ installer                                # å®‰è£…è„šæœ¬
    â”œâ”€â”€ conf                                     # é…ç½®æ–‡ä»¶
    â”‚   â”œâ”€â”€ mysql                                # MySQL é…ç½®
    â”‚   â””â”€â”€ redis                                # Redis é…ç½®
    â””â”€â”€ shells                                   # è„šæœ¬
    ``` 


## 2 å®‰è£…åŸºç¡€ POM

!!! Abstract ""

    è¯¥å‘½ä»¤ä¼šå°† `parent pom` å®‰è£…åˆ°æœ¬åœ° Maven ä»“åº“ï¼Œä½¿å…¶ä»–å¤–éƒ¨å­å·¥ç¨‹å¯ä»¥è·å–æœ€æ–°çš„ `<properties>` é…ç½®ã€‚

    ```bash
    ./mvnw install -N
    ```


### 3 åç«¯æ„å»º

!!! Abstract ""

    ğŸ“Œ æç¤ºï¼šç¡®ä¿å·²æ­£ç¡®å®‰è£… JDK 21 åŠä»¥ä¸Šç‰ˆæœ¬å’Œ Maven ç¯å¢ƒã€‚

    æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ„å»ºåç«¯æ¨¡å—ï¼ˆå¦‚ `framework`ã€`crm`ã€`app` ç­‰ï¼‰å¹¶å®‰è£…åˆ°æœ¬åœ°ä»“åº“ï¼š

    ```bash
    ./mvnw clean install -DskipTests -DskipAntRunForJenkins --file backend/pom.xml
    ```
    å‚æ•°è¯´æ˜ï¼š
    
    * `-DskipTests`: è·³è¿‡æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œã€‚
    * `-DskipAntRunForJenkins`: è·³è¿‡ Jenkins ä½¿ç”¨çš„ Ant ä»»åŠ¡ã€‚

## 3.1 ğŸ§© åç«¯å‚æ•°é…ç½®è¯´æ˜

!!! Abstract ""

    åœ¨æœ¬åœ°è¿è¡Œ **Cordys CRM** é¡¹ç›®æ—¶ï¼Œéœ€è¦åœ¨æœ¬åœ°åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š
    
    ```
    /opt/cordys/conf/cordys-crm.properties

    ```
    ğŸ’¡ **æç¤ºï¼š**
    ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹åº”ç”¨ â€˜Applicationâ€™ å¯åŠ¨å‚æ•°ï¼Œè‡ªå®šä¹‰é…ç½®æ–‡ä»¶çš„åŠ è½½è·¯å¾„ã€‚

    ### âš™ï¸ é…ç½®ç¤ºä¾‹
    
    ```properties
    # ==============================
    # æ•°æ®åº“è¿æ¥é…ç½®
    # ==============================
    # æ•°æ®åº“è¿æ¥ URLï¼Œè¯·æ ¹æ®å®é™…ç¯å¢ƒä¿®æ”¹ IP ä¸æ•°æ®åº“åç§°
    spring.datasource.url=jdbc:mysql://ä½ çš„ MySQL IP:3306/cordys-crm?autoReconnect=false&useUnicode=true&characterEncoding=UTF-8&characterSetResults=UTF-8&zeroDateTimeBehavior=convertToNull&useSSL=false
    
    # æ•°æ®åº“ç”¨æˆ·å
    spring.datasource.username=root
    
    # æ•°æ®åº“å¯†ç 
    spring.datasource.password=CordysCRM@mysql
    
    
    # ==============================
    # Redis ç¼“å­˜é…ç½®
    # ==============================
    # Redis æœåŠ¡å™¨åœ°å€
    spring.data.redis.host=ä½ çš„ Redis IP
    
    # Redis ç«¯å£
    spring.data.redis.port=6379
    
    # Redis å¯†ç 
    spring.data.redis.password=CordysCRM@redis
    
    # Redis Session å­˜å‚¨æ–¹å¼ï¼ˆindexed æ¨èï¼‰
    spring.session.redis.repository-type=indexed
    
    # Session è¿‡æœŸæ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼Œç¤ºä¾‹ä¸º 12 å°æ—¶ï¼‰
    spring.session.timeout=43200s

    ```


## 4 å‰ç«¯æ„å»º

!!! Abstract ""

     ğŸ“Œ æç¤ºï¼šç¡®ä¿å·²æ­£ç¡®å®‰è£… Node.js å’Œä¾èµ–ç¯å¢ƒã€‚

    ### å·¥ç¨‹åˆå§‹åŒ–&è¿è¡Œ
    
    åœ¨`/packages`ç›®å½•ä¸‹è¿è¡Œä¾èµ–å®‰è£…å‘½ä»¤ï¼š
    
    ```node
    pnpm i -w
    ```
    
    ç»Ÿä¸€æ„å»ºå·¥ç¨‹ï¼š
    
    ```node
    npm run build
    ```
    
    ### mobile ç§»åŠ¨ç«¯å·¥ç¨‹åŒ…
    
    ç§»åŠ¨ç«¯å·¥ç¨‹ç”± Vite+Vue3+TS+Vant-UI åŸºç¡€æ¡†æ¶ç»„æˆã€‚
    
    è¿è¡Œç§»åŠ¨ç«¯é¡¹ç›®ï¼š
    
    ```node
    cd package/mobile

    npm run dev
    ```
    
    åœ¨`package/mobile`ä¸‹å•ç‹¬æ„å»ºç§»åŠ¨ç«¯é¡¹ç›®ï¼š
    
    ```node
    npm run build
    ```
    
    ### mobile è°ƒè¯•&å¼€å‘

    ä¸ºäº†æ–¹ä¾¿ç§»åŠ¨ç«¯é¡¹ç›®çš„å¼€å‘è°ƒè¯•ï¼Œå¯ä»¥é€šè¿‡æ¨¡æ‹Ÿç™»å½•æ€ï¼š

        1. å¯åŠ¨ `web` é¡¹ç›®å¹¶å®Œæˆç™»å½•ï¼Œç™»å½•åæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œå¤åˆ¶ `localStorage` ä¸­çš„ `sessionId` å’Œ `csrfToken` ä¸¤ä¸ªå±æ€§å€¼ã€‚
        2. å¯åŠ¨ `mobile` é¡¹ç›®ï¼Œæ‰“å¼€æ§åˆ¶å°ï¼Œå°†ç¬¬1æ­¥å¤åˆ¶çš„ `localStorage` å±æ€§å€¼ç²˜è´´è‡³æ§åˆ¶å°ï¼Œåˆ·æ–°é¡µé¢å³å¯æ¨¡æ‹Ÿç™»å½•ã€‚è‹¥ç™»å½•è¿‡æœŸï¼Œé‡æ–°ç™»å½• `web` é¡¹ç›®å¹¶å¤åˆ¶æ–°çš„å±æ€§å€¼æ›¿æ¢å³å¯ã€‚
        3. åœ¨æ‰‹æœºç«¯è°ƒè¯•æ—¶ï¼Œè¿›å…¥é¡µé¢å¹¶å®Œæˆæˆæƒç™»å½•åï¼Œå¿«é€Ÿç‚¹å‡» 10 æ¬¡ç”¨æˆ·ååŒºåŸŸï¼Œåˆ‡æ¢åˆ° `æˆ‘çš„` èœå•ï¼Œå³å¯å”¤èµ· `Eruda` è°ƒè¯•å·¥å…·ã€‚
    
    ### WEB ç«¯å·¥ç¨‹åŒ…
    
    WEB ç«¯å·¥ç¨‹ç”± Vite+Vue3+TS+Naive-UI åŸºç¡€æ¡†æ¶ç»„æˆã€‚
    
    è¿è¡Œ WEB ç«¯é¡¹ç›®ï¼š
    
    ```node
    cd package/web

    npm run dev
    ```
    
    åœ¨`package/web`ä¸‹å•ç‹¬æ„å»º WEB ç«¯é¡¹ç›®ï¼š
    
    ```node
    npm run build
    ```

## 5 æ•´ä½“æ‰“åŒ…

!!! Abstract ""

    ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®Œæ•´çš„æ„å»ºä¸æ‰“åŒ…ï¼š

    ```bash
    ./mvnw clean package
    ```
